
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì—…ë¬´ ìƒíƒœ ë³€ê²½ ë¦¬ëª¨ì»¨</title>
    <style>
        body {
            background-color: #f0f2f5;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            height: 100vh; margin: 0; text-align: center;
        }
        h1 { color: #333; margin-bottom: 5px; font-size: 24px; }
        p { color: #666; margin-bottom: 40px; font-size: 14px; }
        
        .btn {
            width: 220px; height: 220px;
            border-radius: 50%; border: none;
            font-size: 24px; font-weight: 800; color: white;
            cursor: pointer; transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); /* íŒŒë€ìƒ‰ ê³„ì—´ */
            position: relative; overflow: hidden;
        }
        .btn:active { transform: scale(0.95); }
        .btn:disabled { background: #ccc; cursor: not-allowed; box-shadow: none; }
        
        .icon { font-size: 50px; margin-bottom: 10px; display: block; }
        
        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loader {
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%; border-top: 5px solid white;
            width: 30px; height: 30px;
            animation: spin 1s linear infinite;
            display: none; margin-bottom: 10px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .status { margin-top: 30px; font-weight: bold; color: #444; min-height: 24px; padding: 0 20px; line-height: 1.5; }
    </style>
</head>
<body>

    <h1>í‡´ê·¼</h1>
    <p>ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ 'í‡´ê·¼' ìƒíƒœë¡œ ë³€ê²½í•©ë‹ˆë‹¤.</p>

    <button class="btn" id="mainBtn" onclick="sendSignal()">
        <div class="loader" id="spinner"></div>
        <span class="icon" id="btnIcon">ğŸ’¼</span>
        <span id="btnText">í‡´ê·¼í•˜ê¸°</span>
    </button>

    <div class="status" id="statusMsg">ëŒ€ê¸° ì¤‘...</div>

    <script>
        // =================================================
        const SECRET_KEY = "hmg_checkout_secret_key_1234"; 
        // =================================================

        let pollInterval;

        function sendSignal() {
            const btn = document.getElementById('mainBtn');
            const icon = document.getElementById('btnIcon');
            const text = document.getElementById('btnText');
            const spinner = document.getElementById('spinner');
            const msg = document.getElementById('statusMsg');
            
            // UI ë³€ê²½ (ë¡œë”© ì¤‘)
            btn.disabled = true;
            icon.style.display = "none";
            spinner.style.display = "block";
            text.innerText = "ì²˜ë¦¬ ì¤‘...";
            msg.innerText = "ğŸ“¡ ë§¥ë¶ì— ëª…ë ¹ ì „ì†¡ ì¤‘...";
            msg.style.color = "#007AFF";

            // ì‹ í˜¸ ì „ì†¡ (íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨)
            const now = new Date().getTime();
            const url = `https://dweet.io/dweet/for/${SECRET_KEY}?cmd=checkout&t=${now}`;

            fetch(url)
            .then(() => {
                msg.innerText = "â³ ë§¥ë¶ ì‘ì—… ì¤‘... (ê²°ê³¼ ëŒ€ê¸°)";
                // ê²°ê³¼ í™•ì¸ì„ ìœ„í•œ í´ë§ ì‹œì‘ (2ì´ˆë§ˆë‹¤ í™•ì¸)
                pollInterval = setInterval(checkResult, 2000);
            })
            .catch(() => {
                resetBtn("âŒ ì „ì†¡ ì‹¤íŒ¨", "red");
            });
        }

        function checkResult() {
            // ë§¥ë¶ì´ ë³´ë‚¸ ì™„ë£Œ ì‹ í˜¸('done')ê°€ ìˆëŠ”ì§€ í™•ì¸
            fetch(`https://dweet.io/get/latest/dweet/for/${SECRET_KEY}`)
            .then(res => res.json())
            .then(data => {
                if (data.with && data.with.length > 0) {
                    const content = data.with[0].content;
                    
                    // ì„±ê³µ ì‹ í˜¸ ê°ì§€
                    if (content.cmd === "done" && content.status === "success") {
                        clearInterval(pollInterval);
                        successBtn();
                    }
                    // ì‹¤íŒ¨ ì‹ í˜¸ ê°ì§€
                    else if (content.cmd === "done" && content.status === "fail") {
                        clearInterval(pollInterval);
                        resetBtn("âŒ ë§¥ë¶ì—ì„œ ì˜¤ë¥˜ ë°œìƒ", "red");
                    }
                }
            });
        }

        function successBtn() {
            const btn = document.getElementById('mainBtn');
            const text = document.getElementById('btnText');
            const spinner = document.getElementById('spinner');
            const icon = document.getElementById('btnIcon');
            const msg = document.getElementById('statusMsg');

            spinner.style.display = "none";
            icon.innerText = "âœ…";
            icon.style.display = "block";
            text.innerText = "ì™„ë£Œë¨";
            btn.style.background = "#4CD964"; // ë…¹ìƒ‰
            msg.innerText = "ğŸ‰ ì •ìƒì ìœ¼ë¡œ í‡´ê·¼ì´ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤!";
            msg.style.color = "#4CD964";

            // 5ì´ˆ ë’¤ ë³µê·€
            setTimeout(() => {
                icon.innerText = "ğŸ’¼";
                text.innerText = "ë³€ê²½í•˜ê¸°";
                btn.style.background = "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)";
                btn.disabled = false;
                msg.innerText = "ëŒ€ê¸° ì¤‘...";
                msg.style.color = "#444";
            }, 5000);
        }

        function resetBtn(message, color) {
            const btn = document.getElementById('mainBtn');
            const spinner = document.getElementById('spinner');
            const icon = document.getElementById('btnIcon');
            const text = document.getElementById('btnText');
            const msg = document.getElementById('statusMsg');

            spinner.style.display = "none";
            icon.style.display = "block";
            text.innerText = "ë³€ê²½í•˜ê¸°";
            btn.disabled = false;
            msg.innerText = message;
            msg.style.color = color;
        }
    </script>
</body>
</html>
